---
title: "European Diabetes Epidemiology Group Conference, 2018"
output: 
  postr::flex_dashboard_poster:
    render_print: false
---


## Header row {data-height=15}

```{r setup, message = FALSE, echo = FALSE}
devtools::load_all()
library(pls)
library(dplyr)
library(ggplot2)
library(patchwork)
knitr::opts_chunk$set(echo = FALSE)
```

###

<table style="width:100%">
<tr>
    <td><h3>
  **Specific clusters of fatty acids (FA) across multiple serum lipid fractions underlie pathophysiological features of type 2 diabetes in the Canadian Prospective Metabolism and Islet Cell Evaluation (PROMISE) cohort**
    </h3></td>
    <td rowspan="2">
    <!--<img src="resources/logo.png" style="width:128px"></img>-->
    </td>
</tr>
<tr>
    <td>
    **Luke W. Johnston, Zhen Liu, Ravi Retnakaran, Stewart B. Harris, Richard P. Bazinet, Anthony J. Hanley**
    </td>
</tr>
<tr>
    <td>
    *University of Toronto, Toronto, Canada*
    </td>
</tr>
</table> 

## Body row {data-height=75}

###

#### **Background and rationale**

Since FA within individual lipid fractions fulfill distinct physiological
functions, specific clusters of FA across these fractions could be informative
regarding diabetes risk. Our aim, therefore, was to identify specific clusters
in the composition of FA across multiple lipid fractions and determine their
association with insulin sensitivity (IS) and beta-cell function.

#### **Methods**

Adults at risk for diabetes (n=477) had blood drawn at fasting and during an
OGTT. FA from triacylglycerol (TGFA), phospholipid (PL), cholesteryl ester (CE),
and non-esterified (NEFA) fractions were quantified from fasting samples and the
mole percent (mol%) of total lipids was calculated. Outcome measures included
the Matsuda index (ISI) for IS and the Insulin Secretion-Sensitivity Index-2
(ISSI-2) for beta-cell function. Partial least squares (PLS) was used to
identify underlying clusters in the FA composition, with FA from all lipid
fractions included as the predictor variables and ISI or ISSI-2 as the response
variables, in two separate PLS models.

{{include DOI to code.}}

### **Column 2 title**

```{r inline}
# Models
fit_isi <- pls_model(project_data, outcome = "lISI", ncomp = 4) 
fit_issi2 <- pls_model(project_data, outcome = "lISSI2", ncomp = 4) 

# Explained Variance
# ISI:
Y_explvar_isi <- (100 * drop(pls::R2(fit_isi, estimate = "train", intercept = FALSE)$val))[2] %>% 
    round(1) %>% as.character()
X_explvar_isi <- explvar(fit_isi)[1:2] %>% 
    sum() %>% round(1) %>% as.character()
    
# ISSI-2
Y_explvar_issi2 <- (100 * drop(pls::R2(fit_issi2, estimate = "train", intercept = FALSE)$val))[2] %>% 
    round(1) %>% as.character()
X_explvar_issi2 <- explvar(fit_issi2)[1:2] %>% 
    sum() %>% round(1) %>% as.character()

# Largest contributors
lc_isi <- large_contributors(fit_isi)$fattyacid %>% 
    grep("TG", ., value = TRUE)
lc_issi2 <- large_contributors(fit_issi2)$fattyacid %>% 
    grep("TG", ., value = TRUE) 
tg_contrib <- intersect(lc_isi, lc_issi2) %>% 
    stringr::str_replace_all(" ", "") %>% 
    paste(collapse = ", ")
estrange <- analyze_gee_pls() %>% 
    group_by(Yterms) %>% 
    mutate(estimate = round(estimate, 1)) %>% 
    summarize(estimate = paste(estimate, collapse = "-"))
```

**Results**:
The first two PLS components (C1 and C2) were extracted from the two models. These components
explained `r Y_explvar_issi2`-`r Y_explvar_isi`% of the variance in the
responses and `r X_explvar_issi2`-`r X_explvar_isi`% in the FA. TGFA and NEFA had 
strong negative loadings on C1 and C2, respectively (Figure A),
although only a subset of TGFA strongly correlated with the component scores
(i.e. `r tg_contrib`; Figure B). A lower PLS score 
(indicating higher mol% of these specific TGFA)
associated with `r estrange$estimate[1]`% lower ISI and `r estrange$estimate[2]`% lower ISSI-2.

```{r fig_heatmap}
# Correlation heatmap: 2 x 2 facets with lipid fractions. FA by outcomes.
plot_heatmap(corr_pct) +
    facet_grid(~ Fraction, switch = "x") +
    theme(strip.placement = "outside",
          panel.border = element_rect(fill = NA, colour = "grey80"))
# plot_heatmap(corr_conc) +
#     facet_grid(~ Fraction, switch = "x") +
#     theme(strip.placement = "outside",
#           panel.border = element_rect(fill = NA, colour = "grey80"))
```

```{r fig_pls}
# PLS loadings and corr circle plots: 2 x 2 of loadings on left and corr on right.
# - Loadings show 2-3 Components?
pls_loadings_pct %>% 
    filter(Outcome == "lISI") %>% 
    plot_loadings()
pls_loadings_conc %>% 
    filter(Outcome == "lISI") %>% 
    plot_loadings()

pls_corr_pct %>% 
    filter(Outcome == "lISI") %>% 
    plot_corr_comps()
```

```{r, fig.height=3, fig.width=7, dev="png", dpi=180}
# Figure
library(ggplot2)
fig_loadings <- pls_model(project_data, "lISI", 2) %>% 
    plot_loadings() +
    ggtitle(paste0("A: Loadings of the FA on the components ", 
                   "for ISI. Larger loadings\nindicate the variable ",
                   "contributes more to the component.")) +
    theme(title = element_text(size = 6))

fig_corr <- plot_corr_comps("lISI") +
    ggtitle(paste0("B: Correlations of component scores with FA\nvalues for ISI.", 
            " FA between the two circles ",
            "indicate\na strong correlation to the scores.")) +
    theme(title = element_text(size = 6))

fig_loadings + fig_corr + plot_layout(ncol = 2, widths = c(3, 2))
```

```{r}
fig_loadings <- pls_model(project_data, "lISSI2", 2) %>% 
    plot_loadings() +
    ggtitle(paste0("A: Loadings of the FA on the components ", 
                   "for ISSI-2. Larger loadings\nindicate the variable ",
                   "contributes more to the component.")) +
    theme(title = element_text(size = 6))

fig_corr <- plot_corr_comps("lISSI2") +
    ggtitle(paste0("B: Correlations of component scores with FA\nvalues for ISSI-2.", 
            " FA between the two circles ",
            "indicate\na strong correlation to the scores.")) +
    theme(title = element_text(size = 6))

fig_loadings + fig_corr + plot_layout(ncol = 2, widths = c(3, 2))
```

### **Column 3 title**

**Conclusions**:
We identified a cluster of TGFA that had strong negative associations with IS
and beta-cell function. These TGFA (e.g. 16:1n-7) are
reported to be markers of de novo lipogenesis from simple carbohydrates and 
to exhibit lipotoxic effects. Our results suggest that
only a subset of FA from a broad spectrum of serum FA may underlie the association
between lipids and glucose dysregulation, and that these lipids are possible
mediators between the reported associations of carbohydrate intake and diabetes
risk.

## Footer row {data-height=10} 

### Contact information {data-width=50 .small}

| Luke W. Johnston, MSc, PhD
| Email: lwjohnst@ph.au.dk
| GitHub: https://github.com/lwjohnst86
| DOI for code and poster: {{DOI, maybe QC code?}}
| ORCID: <a href="https://orcid.org/0000-0003-4169-2616" target="orcid.widget" rel="noopener noreferrer" style="vertical-align:top;"><img src="https://orcid.org/sites/default/files/images/orcid_16x16.png" style="width:1em;margin-right:.5em;" alt="ORCID iD icon">orcid.org/0000-0003-4169-2616</a>

![ORCID QR Code](resources/ORCID.png)

### References {data-width=50 .small}
